{
    "$schema": "http://json-schema.org/draft-07/schema",
    "title": "Ashes of War",
    "type": "object",
    "properties": {
        "AshesOfWar": {
            "title": "Spell Map",
            "additionalProperties": false,
            "propertyNames": {
                "$ref": "./enums/ash-of-war-names.schema.json"
            },
            "patternProperties": {
                "^.+$": {
                    "type": "object",
                    "$ref": "#/definitions/AshOfWar"
                }
            }
        }
    },
    "required": ["AshesOfWar"],
    "definitions": {
        "AshOfWar": {
            "title": "Ash Of War",
            "description": "Schema for Ash of War items.",
            "allOf": [{"$ref": "item.schema.json"}],
            "properties": {
                "name": {
                    "#comment": "Override list of possible names to be Ash of War names only.",
                    "$ref": "./enums/ash-of-war-names.schema.json"
                },
                "effective_name": {
                    "description": "Name of this item without the 'Ash of War: ' prefix.",
                    "type": "string",
                    "pattern": "^[0-9a-zA-Z '()]+$"
                },
                "fp_cost": {
                    "description": "Cost of FP to perform for each attack. Stays the same across all weapons.",
                    "type": "object",
                    "propertyNames": {
                        "$ref": "./enums/action-names.schema.json"
                    },
                    "patternProperties": {
                        "^.+$": {
                            "type": "integer",
                            "minimum": 0,
                            "default": 0
                        }
                    },
                    "additionalProperties": false,
                    "required": ["skill_L2_1"]
                },
                "is_chargable": {
                    "description": "Specifies whether the skill can be charged",
                    "type": "boolean",
                    "default": false
                },
                "classes": {
                    "description": "Applicable weapons classes this skill can be applied to.",
                    "type": "array",
                    "minItems": 1,
                    "items": { "$ref": "./enums/armament-class-names.schema.json" }
                },
                "base_affinity": {
                    "description": "Base affinity the Ash of War comes with.",
                    "$ref": "./enums/affinity-names.schema.json"
                },
                "affinities": {
                    "description": "List of affinities this Ash of War can provide, assuming all Whetblades are available.",
                    "type": "array",
                    "minItems": 1,
                    "items": {
                        "$ref": "./enums/affinity-names.schema.json"
                    },
                    "default": ["Standard", "Heavy", "Keen", "Quality", "Fire", "Flame Art", "Lightning", "Sacred", "Magic", "Cold", "Poison", "Blood", "Occult"]
                },
                "moveset": {
                    "description": "Explanation of moveset based on individual actions.",
                    "type": "object",
                    "propertyNames": { "$ref": "./enums/action-names.schema.json" },
                    "patternProperties": {
                        "^.+$": {
                            "description": "Short summary of what is performed in order; lowercase, no sentences.",
                            "type": "array",
                            "minItems": 1,
                            "items": { "type": "string", "pattern": "^[0-9a-z '()]+$" }
                        }
                    },
                    "required": ["skill_L2_1"]
                },
                "attack_data": {
                    "description": "Specific properties of the moveset based on individual actions. These values can differ per weapon, so each move may contain special override fields for class names and weapon names to exactly specify when it's utilized. If no overrides are present, all weapon instances can be assumed. For the sake of data structure shallowness, all attacks are grouped together with distinctive overrides. From a specific weapon perspective, each array should be searched for elements containing matching overrides or none at all.",
                    "type": "object",
                    "propertyNames": { "$ref": "./enums/action-names.schema.json" },
                    "patternProperties": {
                        "^.+$": {
                            "description": "Array of all objects describing attacks possible from this action.",
                            "type": "array",
                            "minItems": 1,
                            "items": { "$ref": "#/definitions/AshOfWarAttackData" }
                        }
                    },
                    "required": ["skill_L2_1"]
                }
            },
            "required": [
                "effective_name",
                "is_chargable",
                "classes",
                "base_affinity",
                "affinities",
                "moveset",
                "attack_data"
            ]
        },
        "AshOfWarAttackData": {
            "type": "object",
            "properties": {
                "attack_id": {
                    "description": "INTERNAL USE ONLY. Internal attack ID of this action as it appears in the AoW spreadsheet. Used for ease of identification when updating information. If, and only if, not present, 'attack_name' should be used instead.",
                    "type": "integer",
                    "minimum": 0
                },
                "attack_name": {
                    "description": "INTERNAL USE ONLY. Name of this action as it appears in the AoW spreadsheet. Used for ease of identification when updating information. Names can duplicate, use if, and only if, AtkId is nonexistent.",
                    "type": "string",
                    "minLength": 1
                },
                "class_overrides": {
                    "description": "Array of weapon class names which utilize this attack dataset.",
                    "type": "array",
                    "minItems": 1,
                    "items": { "$ref": "./enums/armament-class-names.schema.json" }
                },
                "weapon_overrides": {
                    "description": "Array of weapon names which utilize this attack dataset.",
                    "type": "array",
                    "minItems": 1,
                    "items": { "$ref": "./enums/armament-names.schema.json" }
                },
                "sp_cost_base": {
                    "description": "Base stamina cost of this attack, this value should be multiplied by the stamina consumption rate of a specific weapon.",
                    "type": "integer",
                    "minimum": 0,
                    "default": 0
                },
                "motion_values": {
                    "description": "Motion values of this attack.",
                    "type": "object",
                    "properties": {
                        "physical": { "type": "integer", "minimum": 0, "default": 0 },
                        "magic": { "type": "integer", "minimum": 0, "default": 0 },
                        "fire": { "type": "integer", "minimum": 0, "default": 0 },
                        "lightning": { "type": "integer", "minimum": 0, "default": 0 },
                        "holy": { "type": "integer", "minimum": 0, "default": 0 }
                    },
                    "additionalProperties": false

                }
            },
            "oneOf": [
                {
                    "required": ["attack_id", "sp_cost_base", "motion_values"],
                    "not": { "required": ["attack_name"] }
                },
                {
                    "required": ["attack_name", "sp_cost_base", "motion_values"],
                    "not": { "required": ["attack_id"] }
                }
            ],
            "additionalProperties": false
        }
    }
}
